################################################
### üåê ENVIRONMENT
################################################
@baseUrl = http://localhost:4000/api
# @baseUrl = https://help-ride-api.vercel.app/api

# Fill these from responses as you test
@accessToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJmMzdkMGE0NS1lMGMxLTRkN2MtOWY3Yy1iM2IzY2FkMGIzMTEiLCJyb2xlRGVmYXVsdCI6InBhc3NlbmdlciIsImlhdCI6MTc2NTIxNzY0OSwiZXhwIjoxNzY1MjE4NTQ5fQ.y5yMIPbHg_IQqkcqpS8dM2MUIqt8PNhPYqz26WajeBQ
@driverAccessToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJmMzdkMGE0NS1lMGMxLTRkN2MtOWY3Yy1iM2IzY2FkMGIzMTEiLCJyb2xlRGVmYXVsdCI6InBhc3NlbmdlciIsImlhdCI6MTc2NTIxNzY0OSwiZXhwIjoxNzY1MjE4NTQ5fQ.y5yMIPbHg_IQqkcqpS8dM2MUIqt8PNhPYqz26WajeBQ
@rideId = c2a3c70b-10fa-4a67-a9e1-ac7fb9abe3f0
@userId = f37d0a45-e0c1-4d7c-9f7c-b3b3cad0b311
@email = patel.rishi3001@gmail.com
@otp = 898767

################################################
### ü©∫ HEALTH CHECK
################################################
GET {{baseUrl}}/health
Accept: application/json

###

################################################
### üîê AUTH ‚Äì EMAIL/PASSWORD + OTP
################################################

### REGISTER WITH EMAIL/PASSWORD
# Triggers an email OTP for verification.
POST {{baseUrl}}/auth/register
Content-Type: application/json

{
  "name": "Email User",
  "email": "{{email}}",
  "password": "StrongPass123!"
}

###

### LOGIN WITH EMAIL/PASSWORD
# Use same email/password as above.
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "{{email}}",
  "password": "StrongPass123!"
}

###

### RESEND EMAIL VERIFICATION OTP
POST {{baseUrl}}/auth/verify-email/send-otp
Content-Type: application/json

{
  "email": "{{email}}"
}

###

### VERIFY EMAIL WITH OTP
# Replace {{otp}} with the 6-digit code from your email.
POST {{baseUrl}}/auth/verify-email/verify-otp
Content-Type: application/json

{
  "email": "{{email}}",
  "otp": "{{otp}}"
}

###

################################################
### üîê AUTH ‚Äì OAUTH
################################################

### OAUTH LOGIN (GOOGLE)
POST {{baseUrl}}/auth/oauth
Content-Type: application/json

{
  "provider": "google",
  "providerUserId": "google-1234567890",
  "email": "testuser@example.com",
  "name": "Test User",
  "avatarUrl": "https://example.com/avatar.png"
}

###

################################################
### üë§ AUTH ‚Äì CURRENT USER
################################################

### GET AUTHENTICATED USER
GET {{baseUrl}}/auth/me
Authorization: Bearer {{accessToken}}
Accept: application/json

###

### TEST INVALID TOKEN
GET {{baseUrl}}/auth/me
Authorization: Bearer invalid.token.123
Accept: application/json

###

################################################
### üöó RIDES ‚Äì DRIVER FLOW
################################################

### CREATE RIDE  (requires verified driver token)
POST {{baseUrl}}/rides
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "fromCity": "Waterloo",
  "fromLat": 43.4643,
  "fromLng": -80.5204,
  "toCity": "Toronto",
  "toLat": 43.6532,
  "toLng": -79.3832,
  "startTime": "2025-12-15T14:00:00.000Z",
  "pricePerSeat": 20.5,
  "seatsTotal": 3
}

###

### SEARCH RIDES (PUBLIC)
GET {{baseUrl}}/rides?fromCity=Waterloo&toCity=Toronto&seats=1
Accept: application/json

###

### GET MY RIDES  (driver only)
GET {{baseUrl}}/rides/me/list
Authorization: Bearer {{accessToken}}
Accept: application/json

###

### SET A RIDE ID FROM PREVIOUS RESPONSE
# Example:
# @rideId = 8cc76017-9a9e-4b4d-88fa-6761c2de1685


### GET RIDE BY ID
GET {{baseUrl}}/rides/{{rideId}}
Accept: application/json

###

### UPDATE RIDE (driver only)
PUT {{baseUrl}}/rides/{{rideId}}
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "fromCity": "Waterloo",
  "fromLat": 43.4643,
  "fromLng": -80.5204,
  "toCity": "Toronto",
  "toLat": 43.6532,
  "toLng": -79.3832,
  "startTime": "2025-12-15T15:00:00.000Z",
  "pricePerSeat": 22.5,
  "seatsTotal": 4
}

###

### DELETE / CANCEL RIDE (driver only)
DELETE {{baseUrl}}/rides/{{rideId}}
Authorization: Bearer {{accessToken}}

###

################################################
### üì© BOOKINGS ‚Äì PASSENGER & DRIVER
################################################

### SEARCH RIDES (pick one to book)
GET {{baseUrl}}/rides?fromCity=Waterloo&toCity=Toronto&seats=1
Accept: application/json

###

### CREATE BOOKING (PASSENGER REQUESTS RIDE)
POST {{baseUrl}}/bookings/{{rideId}}
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "seats": 1
}

###

### GET MY BOOKINGS (PASSENGER)
GET {{baseUrl}}/bookings/me/list
Authorization: Bearer {{accessToken}}
Accept: application/json

###

### DRIVER: GET BOOKINGS FOR A RIDE
GET {{baseUrl}}/bookings/ride/{{rideId}}
Authorization: Bearer {{driverAccessToken}}
Accept: application/json

###

################################################
### üßë‚Äç‚úàÔ∏è DRIVER PROFILE
################################################

# Set userId to the driver's user id (from /auth/me)

### CREATE DRIVER PROFILE (current user)
POST {{baseUrl}}/drivers
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "carMake": "Toyota",
  "carModel": "Corolla",
  "carYear": "2020",
  "carColor": "White",
  "plateNumber": "ABC-123",
  "licenseNumber": "LIC-987654",
  "insuranceInfo": "Intact Insurance - Policy #123456"
}

###

### GET DRIVER PROFILE (by userId)
GET {{baseUrl}}/drivers/{{userId}}
Accept: application/json

###

### UPDATE DRIVER PROFILE
PUT {{baseUrl}}/drivers/{{userId}}
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "carColor": "Matt Black",
  "carModel": "Corolla SE"
}

###

################################################
### ‚úÖ BOOKING CONFIRMATION FLOW
################################################

# Assumptions:
# - {{accessToken}} = passenger token (verified email)
# - {{driverAccessToken}} = driver token (verified email)
# - {{rideId}} = a ride created by the driver

### 1) PASSENGER CREATES PENDING BOOKING
POST {{baseUrl}}/bookings/{{rideId}}
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "seats": 1
}

###

### 2) PASSENGER: VIEW MY BOOKINGS (TO GET bookingId)
GET {{baseUrl}}/bookings/me/list
Authorization: Bearer {{accessToken}}
Accept: application/json

###

# Set bookingId from previous response:
@bookingId = a1c93971-2c20-463f-8cfa-469845367279

### 3) DRIVER: VIEW BOOKINGS FOR THIS RIDE
GET {{baseUrl}}/bookings/ride/{{rideId}}
Authorization: Bearer {{driverAccessToken}}
Accept: application/json

###

### 4a) DRIVER CONFIRMS BOOKING
PUT {{baseUrl}}/bookings/{{bookingId}}/confirm
Authorization: Bearer {{driverAccessToken}}
Accept: application/json

###

### 4b) DRIVER REJECTS BOOKING (alternative path)
PUT {{baseUrl}}/bookings/{{bookingId}}/reject
Authorization: Bearer {{driverAccessToken}}
Accept: application/json

###
